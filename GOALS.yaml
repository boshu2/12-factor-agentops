version: 1
mission: "The operational discipline for working with AI agents â€” principles that turn ad-hoc agent usage into a reliable, compounding practice."

goals:
  # Content coverage: all 12 new factors exist with full writeups
  - id: all-factors-written
    description: "All 12 factors have dedicated files in factors/ with Rule, rationale, and What Good Looks Like sections"
    check: |
      count=0
      for f in factors/0[1-9]-*.md factors/1[0-2]-*.md; do
        [ -f "$f" ] && grep -q 'Rule:' "$f" && grep -q 'What good looks like' "$f" && count=$((count+1))
      done
      [ "$count" -ge 12 ]
    weight: 10

  # README reflects the pivot
  - id: readme-reflects-pivot
    description: "README contains the new tagline and does not reference 'Shift-Left Validation' or 'DevOps for Vibe-Coding'"
    check: |
      grep -q 'Operational Discipline' README.md && \
      ! grep -q 'Shift-Left Validation' README.md && \
      ! grep -q 'DevOps for Vibe-Coding' README.md
    weight: 8

  # No stale framing references anywhere in active content
  - id: no-stale-framing
    description: "No active docs reference 'coding agents only' or the old validation-only framing"
    check: |
      ! grep -rl 'coding agents only\|Shift-Left Validation\|DevOps for Vibe-Coding' \
        factors/ docs/ README.md CONTRIBUTING.md 2>/dev/null | grep -v _archived | grep -q .
    weight: 7

  # Internal link integrity
  - id: no-broken-links
    description: "All markdown internal links resolve to existing files"
    check: |
      broken=0
      for f in $(find . -name '*.md' -not -path './_archived/*' -not -path './.agents/*' -not -path './.beads/*'); do
        grep -oP '\]\(\.\/[^)]+\)' "$f" 2>/dev/null | sed 's/\](\.\///' | sed 's/)//' | while read link; do
          link=$(echo "$link" | sed 's/#.*//')
          [ -n "$link" ] && [ ! -e "$link" ] && broken=$((broken+1)) && echo "BROKEN: $f -> $link"
        done
      done
      [ "$broken" -eq 0 ]
    weight: 6

  # PRODUCT.md exists and is current
  - id: product-defined
    description: "PRODUCT.md exists with Mission, Target Personas, and Competitive Landscape sections"
    check: |
      [ -f PRODUCT.md ] && \
      grep -q '## Mission' PRODUCT.md && \
      grep -q '## Target Personas' PRODUCT.md && \
      grep -q '## Competitive Landscape' PRODUCT.md
    weight: 5

  # Factor file naming matches new factor titles
  - id: factor-naming-consistent
    description: "Factor files are numbered 01-12 and filenames reflect the new factor titles"
    check: |
      expected="01-context-is-everything 02-track-everything-in-git 03-one-agent-one-job 04-research-before-you-build 05-validate-externally 06-lock-progress-forward 07-extract-learnings 08-compound-knowledge 09-measure-what-matters 10-isolate-workers 11-supervise-hierarchically 12-harvest-failures-as-wisdom"
      count=0
      for name in $expected; do
        [ -f "factors/${name}.md" ] && count=$((count+1))
      done
      [ "$count" -ge 12 ]
    weight: 9
